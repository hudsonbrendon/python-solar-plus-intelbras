import pytest

from solar_plus_intelbras.solar_plus_intelbras import SolarPlusIntelbras


@pytest.fixture
def solar_plus_intelbras() -> SolarPlusIntelbras:
    return SolarPlusIntelbras("test@email.com", "test")


@pytest.fixture
def login_response() -> dict:
    return {
        "user": {
            "id": 6851,
            "email": "test@email.com",
            "name": "Test",
            "cpf": "",
            "picture": "",
            "preferences": {
                "currency": "BRL",
                "timezone": "-3",
                "temperatureUnit": "c",
                "sendWeatherNotification": True,
                "sendEnergyTodayNotification": True,
                "sendAlertNotification": True,
            },
        },
        "accessToken": {
            "exp": 1737175716,
            "expAt": "2025-01-18 01:48:36",
            "iat": 1737175416,
            "accessJWT": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InBpY3R1cmUiOiIiLCJpZCI6Njg1MSwiZW1haWwiOiJjb250YXRvLmh1ZHNvbmJyZW5kb25AZ21haWwuY29tIiwibmFtZSI6Ikh1ZHNvbiBCcmVuZG9uIiwiY3BmIjoiIiwicGhvbmUiOiIiLCJjcmVhdGVkQXQiOiIyMDI0LTEyLTE2VDE0OjQ5OjU2LjYxMDY5OC0wMzowMCIsImFjdGl2YXRlZEF0Ijp7IlRpbWUiOiIyMDI0LTEyLTE2VDE0OjQ5OjU2LjYwODEwNS0wMzowMCIsIlZhbGlkIjp0cnVlfSwibGFzdExvZ2luIjoiMjAyNS0wMS0xNyAyMzoyNToxNC4zOTAwMjg0MzYgLTAzMDAgLTAzIG09KzUyMzkyLjQ4ODc5MjE1MSIsInByZWZlcmVuY2VzIjp7ImN1cnJlbmN5IjoiQlJMIiwidGltZXpvbmUiOiItMyIsInRlbXBlcmF0dXJlVW5pdCI6ImMiLCJzZW5kV2VhdGhlck5vdGlmaWNhdGlvbiI6dHJ1ZSwic2VuZEVuZXJneVRvZGF5Tm90aWZpY2F0aW9uIjp0cnVlLCJzZW5kQWxlcnROb3RpZmljYXRpb24iOnRydWV9LCJyZWdpc3RyYXRpb25Ub2tlbiI6ImQxbWNVRzNVSjA5UHN3d0JDLXVFUDk6QVBBOTFiRzJ4Z3dXUDIzVFhab0tiejVIamZpQW9EbnIxeGEtT1haVTZDMXVEQWIyczZPU3NkRHdMQ3VYTWxkdnBYM0ZJcF9jQloxRU4zU2xsZm5nWmVCYU1aNUNsLWhvcGNLajNhWnRWTTE0MEsyT1U4Tno3eHMiLCJhY3RpdmF0aW9uQ29kZSI6ImU2YjE2OGRkZjc0M2QwOWE4OGU2NmYwZWZhMDZiMDE1In0sImV4cCI6MTczNzE3NTcxNiwiaWF0IjoxNzM3MTc1NDE2LCJjb2RlIjoiIiwicm9sZSI6ImNsaWVudCJ9.FXOp76WgRRemmiOr2z4ML6QVEG1fbDYk1LfYK_hm3vs",
        },
        "refreshToken": {
            "exp": 1737261816,
            "expAt": "2025-01-19 01:43:36",
            "iat": 1737175416,
            "refreshJWT": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7InBpY3R1cmUiOiIiLCJpZCI6Njg1MSwiZW1haWwiOiJjb250YXRvLmh1ZHNvbmJyZW5kb25AZ21haWwuY29tIiwibmFtZSI6Ikh1ZHNvbiBCcmVuZG9uIiwiY3BmIjoiIiwicGhvbmUiOiIiLCJjcmVhdGVkQXQiOiIyMDI0LTEyLTE2VDE0OjQ5OjU2LjYxMDY5OC0wMzowMCIsImFjdGl2YXRlZEF0Ijp7IlRpbWUiOiIyMDI0LTEyLTE2VDE0OjQ5OjU2LjYwODEwNS0wMzowMCIsIlZhbGlkIjp0cnVlfSwibGFzdExvZ2luIjoiMjAyNS0wMS0xNyAyMzoyNToxNC4zOTAwMjg0MzYgLTAzMDAgLTAzIG09KzUyMzkyLjQ4ODc5MjE1MSIsInByZWZlcmVuY2VzIjp7ImN1cnJlbmN5IjoiQlJMIiwidGltZXpvbmUiOiItMyIsInRlbXBlcmF0dXJlVW5pdCI6ImMiLCJzZW5kV2VhdGhlck5vdGlmaWNhdGlvbiI6dHJ1ZSwic2VuZEVuZXJneVRvZGF5Tm90aWZpY2F0aW9uIjp0cnVlLCJzZW5kQWxlcnROb3RpZmljYXRpb24iOnRydWV9LCJyZWdpc3RyYXRpb25Ub2tlbiI6ImQxbWNVRzNVSjA5UHN3d0JDLXVFUDk6QVBBOTFiRzJ4Z3dXUDIzVFhab0tiejVIamZpQW9EbnIxeGEtT1haVTZDMXVEQWIyczZPU3NkRHdMQ3VYTWxkdnBYM0ZJcF9jQloxRU4zU2xsZm5nWmVCYU1aNUNsLWhvcGNLajNhWnRWTTE0MEsyT1U4Tno3eHMiLCJhY3RpdmF0aW9uQ29kZSI6ImU2YjE2OGRkZjc0M2QwOWE4OGU2NmYwZWZhMDZiMDE1In0sImV4cCI6MTczNzI2MTgxNiwiaWF0IjoxNzM3MTc1NDE2LCJjb2RlIjoiIiwicm9sZSI6ImNsaWVudCJ9.Y6JFTXgrcc-SD1nYutJj8kwUVvFgS8YaGDLMavNA7V4",
        },
        "accessTokenContaUnica": "",
        "refreshTokenContaUnica": "",
        "loginType": "code",
        "requestIP": "187.19.163.111",
        "registrationToken": "",
        "code": "",
        "role": "client",
        "businessAccount": {
            "id": 0,
            "createdAt": "0001-01-01T00:00:00Z",
            "updatedAt": "0001-01-01T00:00:00Z",
            "userOwnerID": 0,
            "userOwner": {
                "id": 0,
                "createdAt": "0001-01-01T00:00:00Z",
                "updatedAt": "0001-01-01T00:00:00Z",
                "lastLogin": "",
                "email": "",
                "clientID": "",
                "clientSecret": "",
                "picture": "",
                "registrationToken": "",
                "passwordRecoveryCode": "",
                "passwordRecoveryExpiresAt": {
                    "Time": "0001-01-01T00:00:00Z",
                    "Valid": False,
                },
                "name": "",
                "cpf": "",
                "phone": "",
                "activationCode": "",
                "activatedAt": {"Time": "0001-01-01T00:00:00Z", "Valid": False},
                "sessions": None,
                "pushesNotification": None,
                "preferences": {
                    "sendWeatherNotification": None,
                    "sendEnergyTodayNotification": None,
                    "sendAlertNotification": None,
                },
            },
            "name": "",
            "code": "",
            "cnpj": "",
            "webSite": "",
            "phone": "",
        },
    }


@pytest.fixture
def plants() -> dict:
    return {
        "limit": 10,
        "page": 1,
        "sort": "",
        "total_rows": 1,
        "total_rows_in_this_page": 1,
        "total_pages": 1,
        "rows": [
            {
                "id": 2171,
                "picture": "",
                "name": "User Test",
                "userOwnerID": 1111,
                "userOwner": {
                    "id": 1151,
                    "createdAt": "2024-12-16T14:49:56.610698-03:00",
                    "updatedAt": "2025-01-23T00:58:20.285852-03:00",
                    "lastLogin": "2025-01-23 00:58:20.285268014 -0300 -03 m=+36384.151669507",
                    "email": "test@email.com",
                    "clientID": "",
                    "clientSecret": "",
                    "picture": "",
                    "registrationToken": "d1ssUG3UKK9PswwBC-uEP9:APA91bG2xgwWP23TXZoKbz5HjfiAoDnr1xa-OXZU6C1uDAb2s6OSsdDwLCuXMldvpX3FIp_cBZ1EN3SllfngZeBaMZ5Cl-hopcKj3aZtVM140K2OU8Nz7xs",
                    "passwordRecoveryCode": "",
                    "passwordRecoveryExpiresAt": {
                        "Time": "0001-01-01T00:00:00Z",
                        "Valid": False,
                    },
                    "name": "User Test",
                    "cpf": "",
                    "phone": "",
                    "activationCode": "sdf168ssf743d09a88e66f0efa06b015",
                    "activatedAt": {
                        "Time": "2024-12-16T14:49:56.608105-03:00",
                        "Valid": True,
                    },
                    "sessions": None,
                    "pushesNotification": None,
                    "preferences": {
                        "currency": "BRL",
                        "timezone": "-3",
                        "temperatureUnit": "c",
                        "sendWeatherNotification": True,
                        "sendEnergyTodayNotification": True,
                        "sendAlertNotification": True,
                    },
                },
                "users": [],
                "business_accounts": None,
                "weather": {
                    "current": {
                        "cloud": 75,
                        "is_day": 1,
                        "temp_c": 31.2,
                        "temp_f": 88.2,
                        "humidity": 66,
                        "wind_dir": "ESE",
                        "wind_kph": 18,
                        "condition": {
                            "code": 1003,
                            "icon": "//cdn.weatherapi.com/weather/64x64/day/116.png",
                            "text": "Parcialmente nublado",
                        },
                        "wind_degree": 109,
                        "last_updated": "2025-01-22 15:00",
                        "last_updated_epoch": 1737568800,
                    },
                    "location": {
                        "lat": 0,
                        "long": 0,
                        "name": "Test",
                        "tz_id": "America/Fortaleza",
                        "region": "Test",
                        "country": "Brazil",
                        "localtime": "2025-01-22 15:09",
                        "localtime_epoch": 1737569379,
                    },
                },
                "street": "Test",
                "number": "",
                "district": "Test",
                "city": "Test",
                "state": "RN",
                "country": "BR",
                "zip": "59999-999",
                "latitude": -5.933342,
                "longitude": -35.33916,
                "online": False,
                "offgrid": False,
                "status": "WAITING",
                "price": 0.92,
                "capacityInstalled": 5,
                "modulesAmount": 10,
                "last_record": "2025-01-22T18:28:16.986982-03:00",
                "installed_at": "0000-12-31T20:53:32-03:06",
                "createdAt": "2024-12-16T14:49:57.108865-03:00",
                "updatedAt": "2025-01-23T00:52:45.08055-03:00",
                "metrics": {
                    "energyToday": 21.7,
                    "energyTotal": 139.5,
                    "currentPower": 0,
                    "totalEconomy": 128.34000232815742,
                    "todayEconomy": 19.964000362157822,
                    "economyOfLast30": 127.69600231647493,
                    "yearEconomy": 0,
                    "energyOfLast30": 138.8,
                    "savedCo2": 47.513702392578125,
                    "savedTrees": 0.047513701021671295,
                    "savedCoal": 0.055799998342990875,
                },
                "components": {
                    "inverters": 1,
                    "dataloggers": 1,
                    "modules": 0,
                    "alerts": 5,
                    "todayAlerts": 0,
                    "chargeControllers": 0,
                },
            }
        ],
    }


@pytest.fixture
def records_today() -> dict:
    return {
        "data": {
            "rows": [
                {"date": "2025-01-23 05:25", "total": 0},
                {"date": "2025-01-23 05:30", "total": 0},
                {"date": "2025-01-23 05:35", "total": 0},
                {"date": "2025-01-23 05:40", "total": 98},
                {"date": "2025-01-23 05:45", "total": 98},
                {"date": "2025-01-23 05:50", "total": 142},
                {"date": "2025-01-23 05:55", "total": 176},
                {"date": "2025-01-23 06:00", "total": 176},
                {"date": "2025-01-23 06:05", "total": 220},
                {"date": "2025-01-23 06:10", "total": 220},
                {"date": "2025-01-23 06:15", "total": 258},
                {"date": "2025-01-23 06:20", "total": 258},
                {"date": "2025-01-23 06:25", "total": 294},
                {"date": "2025-01-23 06:30", "total": 342},
                {"date": "2025-01-23 06:35", "total": 342},
                {"date": "2025-01-23 06:40", "total": 471},
                {"date": "2025-01-23 06:45", "total": 471},
                {"date": "2025-01-23 06:50", "total": 375},
                {"date": "2025-01-23 06:55", "total": 375},
                {"date": "2025-01-23 07:00", "total": 810},
                {"date": "2025-01-23 07:05", "total": 810},
                {"date": "2025-01-23 07:10", "total": 511},
                {"date": "2025-01-23 07:15", "total": 1334},
                {"date": "2025-01-23 07:20", "total": 1334},
                {"date": "2025-01-23 07:25", "total": 1247},
                {"date": "2025-01-23 07:30", "total": 1247},
                {"date": "2025-01-23 07:35", "total": 2044},
                {"date": "2025-01-23 07:40", "total": 2044},
                {"date": "2025-01-23 07:45", "total": 968},
                {"date": "2025-01-23 07:50", "total": 2632},
                {"date": "2025-01-23 07:55", "total": 2632},
                {"date": "2025-01-23 08:00", "total": 1891},
                {"date": "2025-01-23 08:05", "total": 1891},
                {"date": "2025-01-23 08:10", "total": 1121},
                {"date": "2025-01-23 08:15", "total": 1121},
                {"date": "2025-01-23 08:20", "total": 966},
                {"date": "2025-01-23 08:25", "total": 1114},
                {"date": "2025-01-23 08:30", "total": 1114},
                {"date": "2025-01-23 08:35", "total": 3615},
                {"date": "2025-01-23 08:40", "total": 3615},
                {"date": "2025-01-23 08:45", "total": 3660},
                {"date": "2025-01-23 08:50", "total": 3660},
                {"date": "2025-01-23 08:55", "total": 1086},
                {"date": "2025-01-23 09:00", "total": 1086},
                {"date": "2025-01-23 09:05", "total": 4194},
                {"date": "2025-01-23 09:10", "total": 4194},
                {"date": "2025-01-23 09:15", "total": 1390},
                {"date": "2025-01-23 09:20", "total": 1352},
                {"date": "2025-01-23 09:25", "total": 1352},
                {"date": "2025-01-23 09:30", "total": 1047},
                {"date": "2025-01-23 09:35", "total": 1047},
                {"date": "2025-01-23 09:40", "total": 3334},
                {"date": "2025-01-23 09:45", "total": 4275},
                {"date": "2025-01-23 09:50", "total": 4275},
                {"date": "2025-01-23 09:55", "total": 4224},
                {"date": "2025-01-23 10:00", "total": 4224},
                {"date": "2025-01-23 10:05", "total": 1617},
                {"date": "2025-01-23 10:10", "total": 1617},
                {"date": "2025-01-23 10:15", "total": 5009},
                {"date": "2025-01-23 10:20", "total": 3338},
                {"date": "2025-01-23 10:25", "total": 0},
                {"date": "2025-01-23 10:30", "total": 3338},
                {"date": "2025-01-23 10:35", "total": 1102},
                {"date": "2025-01-23 10:40", "total": 1102},
                {"date": "2025-01-23 10:45", "total": 1391},
                {"date": "2025-01-23 10:50", "total": 1391},
                {"date": "2025-01-23 10:55", "total": 4800},
                {"date": "2025-01-23 11:00", "total": 4800},
                {"date": "2025-01-23 11:05", "total": 2246},
                {"date": "2025-01-23 11:10", "total": 2246},
                {"date": "2025-01-23 11:15", "total": 4769},
                {"date": "2025-01-23 11:20", "total": 2746},
                {"date": "2025-01-23 11:25", "total": 2746},
                {"date": "2025-01-23 11:30", "total": 4540},
                {"date": "2025-01-23 11:35", "total": 4540},
                {"date": "2025-01-23 11:40", "total": 4477},
                {"date": "2025-01-23 11:45", "total": 4477},
                {"date": "2025-01-23 11:50", "total": 4481},
                {"date": "2025-01-23 11:55", "total": 4481},
                {"date": "2025-01-23 12:00", "total": 4596},
                {"date": "2025-01-23 12:05", "total": 4596},
                {"date": "2025-01-23 12:10", "total": 4481},
                {"date": "2025-01-23 12:15", "total": 4417},
                {"date": "2025-01-23 12:20", "total": 4417},
                {"date": "2025-01-23 12:25", "total": 0},
                {"date": "2025-01-23 12:30", "total": 4137},
                {"date": "2025-01-23 12:35", "total": 4161},
                {"date": "2025-01-23 12:40", "total": 4161},
                {"date": "2025-01-23 12:45", "total": 4177},
                {"date": "2025-01-23 12:50", "total": 4177},
                {"date": "2025-01-23 12:55", "total": 4123},
                {"date": "2025-01-23 13:00", "total": 0},
                {"date": "2025-01-23 13:05", "total": 0},
                {"date": "2025-01-23 13:10", "total": 3993},
                {"date": "2025-01-23 13:15", "total": 3993},
                {"date": "2025-01-23 13:20", "total": 3879},
                {"date": "2025-01-23 13:25", "total": 0},
                {"date": "2025-01-23 13:30", "total": 0},
                {"date": "2025-01-23 13:35", "total": 0},
                {"date": "2025-01-23 13:40", "total": 3678},
                {"date": "2025-01-23 13:45", "total": 3678},
                {"date": "2025-01-23 13:50", "total": 3591},
                {"date": "2025-01-23 13:55", "total": 3591},
                {"date": "2025-01-23 14:00", "total": 3490},
                {"date": "2025-01-23 14:05", "total": 3406},
                {"date": "2025-01-23 14:10", "total": 3406},
                {"date": "2025-01-23 14:15", "total": 3307},
                {"date": "2025-01-23 14:20", "total": 3307},
                {"date": "2025-01-23 14:25", "total": 3149},
                {"date": "2025-01-23 14:30", "total": 3149},
                {"date": "2025-01-23 14:35", "total": 3031},
                {"date": "2025-01-23 14:40", "total": 2886},
                {"date": "2025-01-23 14:45", "total": 2886},
                {"date": "2025-01-23 14:50", "total": 2726},
                {"date": "2025-01-23 14:55", "total": 2726},
                {"date": "2025-01-23 15:00", "total": 2560},
                {"date": "2025-01-23 15:05", "total": 2560},
                {"date": "2025-01-23 15:10", "total": 2440},
                {"date": "2025-01-23 15:15", "total": 2440},
                {"date": "2025-01-23 15:20", "total": 2265},
                {"date": "2025-01-23 15:25", "total": 2265},
                {"date": "2025-01-23 15:30", "total": 2089},
                {"date": "2025-01-23 15:35", "total": 1780},
                {"date": "2025-01-23 15:40", "total": 1780},
                {"date": "2025-01-23 15:45", "total": 1466},
                {"date": "2025-01-23 15:50", "total": 1466},
                {"date": "2025-01-23 15:55", "total": 1305},
                {"date": "2025-01-23 16:00", "total": 1133},
                {"date": "2025-01-23 16:05", "total": 1133},
                {"date": "2025-01-23 16:10", "total": 964},
                {"date": "2025-01-23 16:15", "total": 964},
                {"date": "2025-01-23 16:20", "total": 823},
                {"date": "2025-01-23 16:25", "total": 823},
                {"date": "2025-01-23 16:30", "total": 640},
                {"date": "2025-01-23 16:35", "total": 640},
                {"date": "2025-01-23 16:40", "total": 469},
                {"date": "2025-01-23 16:45", "total": 352},
            ],
            "total": 352,
        },
        "status": 200,
    }
